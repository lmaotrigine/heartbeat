<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Troubleshooting - Heartbeat</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Heartbeat</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/lmaotrigine/heartbeat/tree/main/book/src" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/lmaotrigine/heartbeat/edit/main/book/src/troubleshooting.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<p>The first step to debugging issues with your installation is to look at the logs. To make it less of a privacy law
hassle, all logs exist ephemerally only in the console I/O. i.e. they are streamed to stdout/stderr depending on their
origin and severity. Fortunately, inspecting them is easy enough:</p>
<ul>
<li>If you are simply running the server in the background using screen/tmux you can switch to the appropriate windows to
see them.</li>
<li>With Docker, you can view them using <code>docker logs</code>, or <code>docker compose logs</code> if you are using
<code>docker-compose</code>.</li>
<li>If you are using a process manager like <code>systemd</code> or <code>pm2</code>, you can check your journal, or whatever logging facility
it provides. The pertinent error messages will most likely be helpful enough to find out and fix your problem.</li>
</ul>
<p>By default, the maximum log level is <code>INFO</code> for release builds and <code>DEBBUG</code> for debug builds. You should be using
release builds in production. To control the log level, set the <code>RUST_LOG</code> environment variable to an acceptable value.
Consult <a href="https://docs.rs/tracing-subscriber/latest/tracing_subscriber/fmt/index.html#filtering-events-with-environment-variables">this documentation</a> for more information.</p>
<p>Some common pitfalls are documented here, with suggested debugging solutions. If your issue is not listed here, and you
cannot figure it out, we’re happy to help. Open an issue or discussion on GitHub, provide us with the relevant logs and
reproduction steps, and we will do our best to help you out</p>
<h2 id="frequent-problems"><a class="header" href="#frequent-problems">Frequent Problems</a></h2>
<h3 id="cant-connect-using-docker"><a class="header" href="#cant-connect-using-docker">Can’t connect using Docker</a></h3>
<p>The default port is <code>6060</code>. You should map this port to a host port (preferably the same one). If you still cannot
access it from <code>localhost</code>, check <code>docker logs</code> or <code>docker compose logs</code> to verify that the server is listening where
you expect it to, and that the configuration is loaded correctly.</p>
<h3 id="cant-connect-while-not-using-docker"><a class="header" href="#cant-connect-while-not-using-docker">Can’t connect while not using Docker</a></h3>
<p>Without Docker’s networking shenanigans, you should be able to access the server on <code>localhost</code> always. Ensure that the
server hasn’t prematurely exited due to an error or signal. If not, please check that the bind address is the same one
that you are trying to access.</p>
<h3 id="401-errors-on-apibeat"><a class="header" href="#401-errors-on-apibeat">401 errors on <code>/api/beat</code></a></h3>
<p>When you believe you have the right token, but the server is rejecting it, it is likely that the token was regenerated
at some point. Regenerate it once more to ensure that you note it down this time.</p>
<h3 id="401-errors-on-apidevice-routes"><a class="header" href="#401-errors-on-apidevice-routes">401 errors on <code>/api/device</code> routes</a></h3>
<p>If the secret key isn’t being recognized as valid by the server, try temporarily overriding it using environment
variables or command line flags, and see if the issue persists. This will likely help identify the cause of the issue if
it isn’t just a typo.</p>
<h3 id="config-values-from-toml-file-not-being-read-on-docker"><a class="header" href="#config-values-from-toml-file-not-being-read-on-docker">Config values from TOML file not being read on Docker</a></h3>
<p>Make sure your <code>config.toml</code> file is mounted at <code>/.heartbeat/config.toml</code>. This is where the executable looks for the
config file by default. If you overrode this, make sure the mount location matches with the override.</p>
<h3 id="error-communicating-with-database-failed-to-lookup-address-information-name-or-service-not-known"><a class="header" href="#error-communicating-with-database-failed-to-lookup-address-information-name-or-service-not-known"><code>error communicating with database: failed to lookup address information: Name or service not known</code></a></h3>
<p>Heartbeat could not establish a connection to the PostgreSQL server. Make sure that the server is online and reachable
from the network Heartbeat is running on. If there is another message indicating secure connection failure, ensure that
the <code>sqlx-tls</code> feature is enabled in your binary. In release archives, this is always the case, but in Docker, it
requires passing it to the <code>FEATURES</code> build argument.</p>
<h3 id="pool-timed-out-while-waiting-for-an-open-connection"><a class="header" href="#pool-timed-out-while-waiting-for-an-open-connection"><code>pool timed out while waiting for an open connection</code></a></h3>
<p>Your PostgreSQL server is possibly at capacity for maximum connections. Check the server logs or try again after some
time. Failing that, enable debug logging</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="clients/api.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="clients/api.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
